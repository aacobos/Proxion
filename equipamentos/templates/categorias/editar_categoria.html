{% extends 'base.html' %}
{% load static %}

{% block title %}Editar Categoria{% endblock %}

{% block header %}
<h1>Editar Categoria</h1>
{% endblock %}

{% block content %}
<div class="card-form">
    <h2>Editar Categoria de Equipamento</h2>

    <form method="post">
        {% csrf_token %}

        <div class="form-group">
            <label for="nome">Nome da Categoria:</label>
            <input type="text" id="nome" name="nome" value="{{ categoria.nome }}" required>
        </div>

        <h4>Parâmetros Associados:</h4>
        <div class="form-group">
            <div class="checkbox-grid">
                {% for parametro in parametros|dictsort:"nome" %}
                    <label class="checkbox-item {% if parametro in categoria.parametros.all %}selecionado{% endif %}">
                        <input type="checkbox" name="parametros" value="{{ parametro.id }}"
                               {% if parametro in categoria.parametros.all %}checked{% endif %}>
                        <span class="parametro-nome">{{ parametro.nome }}</span>
                    </label>
                {% endfor %}
            </div>
        </div>

        <div class="form-actions">
            <button type="submit" class="btn btn-primary">Salvar</button>
            <a href="{% url 'equipamentos:listar_categorias' %}" class="btn btn-secondary">Cancelar</a>
        </div>
    </form>
</div>
{% endblock %}

{% block extrajs %}
<script>
    // Atualiza visualmente os parâmetros selecionados
    document.addEventListener('DOMContentLoaded', () => {
        const checkboxes = document.querySelectorAll('.checkbox-item input[type="checkbox"]');
        checkboxes.forEach(checkbox => {
            checkbox.addEventListener('change', () => {
                checkbox.parentElement.classList.toggle('selecionado', checkbox.checked);
            });
        });
    });
</script>
{% endblock %}
